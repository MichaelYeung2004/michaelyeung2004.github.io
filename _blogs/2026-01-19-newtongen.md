---
layout: blog
title: 'NewtonGen：通过神经牛顿动力学实现物理一致且可控的文本到视频生成'
date: 2026-01-19
tags:
  - deep learning
  - Text-to-Video Generation
  - paper
---

## Background

当今AI视频生成技术遇到了两个问题：

1. **物理一致性 (Physical Consistency)**：如何保证符合生活常识和物理规律
2. **参数可控性 (Parameter Controllability)**：如何精确地控制视频里物体的运动轨迹、速度等参数

现有的文本到视频模型缺乏对内在物理定律的理解，模型主要依赖于**记忆和模仿**，这使得它很难泛化到分布外的场景。

为了解决上述问题，作者提出了一个名叫 **NewtonGen** 的新框架：

1.  **物理大脑 (NND模块)**：专门训练一个“懂物理”的小模型，作者称之为**神经牛顿动力学 (Neural Newtonian Dynamics, NND)**。这个小模型不负责画画，只负责一件事：**预测物体的运动轨迹**。给它一个物体的初始状态（比如位置、速度），它就能像物理引擎一样，计算出下一秒、再下一秒……物体应该在哪个位置，速度是多少。

2.  **绘画大师 (视频生成模型)**：使用一个现成的、强大的视频生成模型。这个模型非常擅长“画画”，能根据文字描述生成精美的画面，但它不懂物理。

![image-20260119204019963](D:\michaelyeung2004.github.io\assets\images\photos\image-20260119204019963.png)

NewtonGen工作过程分为两个阶段：

+ **第一阶段：训练“物理大脑”**
  *   作者自己用程序模拟制作了很多“物理干净”的视频。所谓“干净”，就是视频里的物体运动完全符合物理公式，没有模糊、没有遮挡，非常标准。就像物理课本里的标准例题一样。
  *   让NND这个“物理大脑”去学习这些标准视频，目标是让它学会准确预测物体的运动。
+ **第二阶段：生成视频**
  1.  **用户下达指令**：你输入文字，比如“一个篮球飞向篮筐”，同时可以指定**物理参数**，比如“初始位置在(x, y)，初始速度是(vx, vy)”。
  2.  **“物理大脑”出马**：训练好的NND接收到这些物理参数后，立刻开始计算，预测出篮球在接下来每一帧画面中的精确位置、朝向、大小等状态。它输出的不是图像，而是一系列**物理状态数据**。
  3.  **数据“翻译”**：将NND输出的这些物理状态数据，转换成一种叫做“**光流 (Optical Flow)**”的东西。可以简单理解为“运动草稿”，它描述了画面中每个像素点应该往哪个方向移动。
  4.  **“绘画大师”上色**：最后，把你的文字描述（比如“在一个晴朗的室外篮球场”）和这个“运动草稿”（光流）一起交给“绘画大师”（视频生成模型）。绘画大师就会一边根据文字画出篮球场的背景，一边严格按照运动草稿来画篮球的每一帧，确保篮球的运动是完全符合物理规律的。



## 神经牛顿动力学（NND）

### 物理状态向量

为了用数学来描述一个物体的运动，我们首先需要定义清楚要追踪哪些物理量。NND定义了一个包含9个维度的“**潜在物理状态向量**” $Z$ 来全面捕捉物体的状态。这就像是给物体填一张体检表，上面有9个项目：

$Z = [x, y, v_x, v_y, \theta, \omega, s, l, a]$

我们来逐一解释这9个项目：

*   $x, y$: 物体中心在二维平面上的**位置**坐标。
*   $v_x, v_y$: 物体中心在x和y方向上的**速度**。
*   $\theta$: 物体的**旋转角度**。比如一个木棍是横着放还是竖着放。
*   $\omega$: 物体的**角速度**，也就是它旋转的快慢。
*   $s$: 物体的**短轴长度** (shortest dimension)。
*   $l$: 物体的**长轴长度** (longest dimension)。
*   $a$: 物体的**投影面积**。

在现实世界中，一个物体可能会**旋转**（需要$\theta, \omega$）、**变形**或者**在3D空间里有远近变化**（这些都可以通过$s, l, a$的变化来近似模拟）。这个9维向量的设计，使得NND有能力去理解和预测不仅仅是平移，还包括旋转、变形等更复杂的运动。

### **带有残差** **MLP** **的线性物理信息神经** ODE

现在我们有了描述物体状态的向量$Z$。接下来的问题是：如果我知道物体在这一刻的状态$Z_t$，如何预测它在下一刻的状态$Z_{t+1}$？ 这就需要一个描述“变化规律”的方程。

物理学的核心就是用微分方程来描述变化。这篇论文的核心数学模型就是一个**常微分方程 (Ordinary Differential Equation, ODE)**。它的本质就是：**一个描述“事物当前的变化率”与“事物当前的状态”之间关系的方程**。

知道了变化率，我们就可以通过积分（累加这些微小的变化）来预测未来的状态。

但是，不同的运动（比如自由落体和弹簧振动）遵循的物理规律（也就是ODE）是不同的。作者如何设计一个能“通吃”多种运动的通用ODE框架呢？他们采用了“**线性模型 + 非线性修正**”的巧妙思想，具体体现在论文的**公式(4)**中：

$a_z \ddot{z} + b_z \dot{z} + c_z z + d_z + \text{MLP}(Z) = 0$

*   **$z$**: 代表我们关心的9维状态向量$Z$中的**任意一个维度**。比如，它可以是x方向的位置$x$，或者是旋转角度$\theta$。
*   **$\dot{z}$** (读作 "z dot"): 这是$z$对时间的一阶导数，代表**速度**。如果$z$是位置$x$，那么$\dot{z}$就是速度$v_x$。
*   **$\ddot{z}$** (读作 "z double dot"): 这是$z$对时间的二阶导数，代表**加速度**。如果$z$是位置$x$，那么$\ddot{z}$就是加速度$a_x$。
*   **$a_z, b_z, c_z, d_z$**: 这四个是**可学习的参数**。可以把它们想象成四个可以调节的“旋钮”。通过在训练中不断调整这四个旋钮的数值，模型就可以模拟出很多**基础的、线性的**物理运动。
    *   例如，对于**匀速运动**，加速度为0，模型会学会让$\ddot{z}$相关的项等于0。
    *   对于**自由落体**，加速度是常数$g$，模型会学会调整参数，让$\ddot{z}$等于一个接近$g$的值。
    *   对于**弹簧振动**（简谐运动），其受力满足$F = -kx$，加速度$a = -(k/m)x$，这个方程的形式和公式(4)的线性部分很像。

*   **$\text{MLP}(Z)$**: 这是整个公式的点睛之笔。MLP (Multi-Layer Perceptron) 是一个标准的**神经网络**。它的作用是**修正和补充**。
    *   前面那个线性部分（$a_z \ddot{z} + ...$）虽然能模拟很多基础物理，但对于复杂的、非线性的情况（比如空气阻力、摩擦力，或者一些未知的复杂动力学）就无能为力了。
    *   MLP这个神经网络的作用，就是根据物体**当前完整的9维状态$Z$**，去学习和预测那些线性部分无法描述的复杂力量，并给出一个**修正项**。

**公式(4)的白话翻译：**
“一个物体在某个维度上的运动规律，可以被一个**‘基础物理公式模板’**（线性部分）和一个**‘高级修正专家’**（MLP神经网络）共同决定。前者负责简单、普适的规律，后者负责复杂、特殊的情况。”

通过这个设计，NND框架变得既有物理学赋予的结构性（线性部分），又有神经网络带来的灵活性和强大拟合能力（MLP部分）。

有了描述变化率的规则（公式4），我们就可以用**公式(5)**来预测未来：

$Z_t = Z_0 + \int_{t_0}^t \text{Func}(Z(\tau)) d\tau$

*   **$Z_t$**: 我们想要预测的、在未来$t$时刻的物体状态。
*   **$Z_0$**: 物体的初始状态（在$t_0$时刻）。
*   **$\text{Func}(Z(\tau))$**: 这代表了在任意时刻$\tau$，物体的状态$Z(\tau)$的变化率是多少。
*   **$\int_{t_0}^t ... d\tau$**: 这是积分符号，在这里你可以简单理解为“**从初始时刻$t_0$到未来时刻$t$，把所有微小时间段内的变化量累加起来**”。

“要想知道物体未来的状态（$Z_t$），你只需要在它的初始状态（$Z_0$）的基础上，把遵循物理规律（Func）产生的每一瞬间的微小变化，从开始一直累加到那个未来时刻。”

在实际计算中，这个积分过程是由一个叫做**ODE求解器 (ODE Solver)** 的现成工具来完成的。

### NND训练：只做“编码”，不做“解码”

现在我们知道了NND的模型结构，那么它是如何学习那些参数（$a_z,b_z,c_z,d_z$和MLP里的权重）的呢？

训练流程非常直接：

1.  **准备数据**：使用前面提到的“物理干净”的模拟视频。
2.  **提取“标准答案”**：用一个叫做**视频物理编码器 ($E_{phys}$)** 的工具，逐帧分析视频，提取出每一帧的真实物理状态$Z_t$。这些就是NND需要学习的“标准答案”。这个编码器是基于一些成熟的计算机视觉技术（如图像分割）实现的，可以精确计算出视频中物体的位置、速度、形状等。
3.  **进行“模拟考试”**：
    *   把视频的**第一帧**的真实物理状态$Z_0$作为**初始条件**，输入给NND。
    *   让NND使用它的ODE模型（公式4和5），一口气预测出后面所有帧的物理状态，我们称之为预测值$\hat{Z}_t$。
4.  **批改“试卷”**：
    *   比较NND的预测值$\hat{Z}_t$和从视频中提取的“标准答案”$Z_t$。
    *   计算两者之间的**差距**，这个差距在机器学习中称为**损失 (Loss)**。
5.  **订正和提高**：使用优化算法（比如梯度下降），根据损失的大小，反向微调NND内部的所有可学习参数，目标是让损失越来越小。
6.  **重复练习**：在整个数据集上成千上万次地重复上述过程，直到NND的预测足够准确。

这里有一个关键点：这个训练架构是**“仅编码器” (Encoder-Only)** 的。也就是说，我们只需要从视频中“编码”出物理状态，而不需要一个“解码器”再把物理状态变回视频画面。这使得训练过程非常轻量和高效，因为它只在抽象的9维物理空间中进行计算，而不用处理高维度的像素数据。



## 物理可控文本到视频生成





